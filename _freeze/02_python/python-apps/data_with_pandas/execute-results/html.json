{
  "hash": "259fc5962c8e631934fd56ac3326b9f8",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Handling Data with Pandas\"\njupyter: python3\nexecute:\n  error: true\norder: 1\n---\n\nIn this module we will learn how to handle data with the pandas library in Python. Pandas is a powerful library that provides data structures and data analysis tools for Python. It is widely used for data manipulation and analysis, making it an essential tool for data scientists and analysts.\n\n::: {#c0605d82 .cell execution_count=1}\n``` {.python .cell-code}\n# Import libraries\nimport pandas as pd\nimport numpy as np\n```\n:::\n\n\n## pandas DataFrames\n\nDataFrames are two-dimensional, size-mutable, potentially heterogeneous tabular data structures with labeled axes (rows and columns). They are similar to SQL tables or Excel spreadsheets. DataFrames can be created from various data sources, such as lists, dictionaries, or CSV files.\n\n::: {#3910a3b7 .cell execution_count=2}\n``` {.python .cell-code}\nkids = [['Mike', 'boy', 7, 128], ['George', 'boy', 4, 112], ['Lily', 'girl', 8, 132], ['Yu', 'girl', 10, 143], ['Dan', 'boy', 9, 138]]\n\ncolNames = ['name', 'gender', 'age', 'height']\n```\n:::\n\n\n::: {#d441593d .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":20,\"status\":\"ok\",\"timestamp\":1754653890523,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=3}\n``` {.python .cell-code}\ndf = pd.DataFrame(data = kids, columns = colNames)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>height</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Mike</td>\n      <td>boy</td>\n      <td>7</td>\n      <td>128</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>George</td>\n      <td>boy</td>\n      <td>4</td>\n      <td>112</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Lily</td>\n      <td>girl</td>\n      <td>8</td>\n      <td>132</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Yu</td>\n      <td>girl</td>\n      <td>10</td>\n      <td>143</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Dan</td>\n      <td>boy</td>\n      <td>9</td>\n      <td>138</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#cf8089ff .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":7,\"status\":\"ok\",\"timestamp\":1754653902698,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=4}\n``` {.python .cell-code}\n# Check the column data types\ndf.dtypes\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nname      object\ngender    object\nage        int64\nheight     int64\ndtype: object\n```\n:::\n:::\n\n\n## Import data from a csv file\n\n::: {#e7e5ba2a .cell execution_count=5}\n``` {.python .cell-code}\ndf = pd.read_csv('diabetes.csv')\n```\n:::\n\n\n::: {#337b86e2 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":54,\"status\":\"ok\",\"timestamp\":1754663054240,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=6}\n``` {.python .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n      <td>148</td>\n      <td>72</td>\n      <td>35</td>\n      <td>0</td>\n      <td>33.6</td>\n      <td>0.627</td>\n      <td>50</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>85</td>\n      <td>66</td>\n      <td>29</td>\n      <td>0</td>\n      <td>26.6</td>\n      <td>0.351</td>\n      <td>31</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>89</td>\n      <td>66</td>\n      <td>23</td>\n      <td>94</td>\n      <td>28.1</td>\n      <td>0.167</td>\n      <td>21</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>137</td>\n      <td>40</td>\n      <td>35</td>\n      <td>168</td>\n      <td>43.1</td>\n      <td>2.288</td>\n      <td>33</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>763</th>\n      <td>10</td>\n      <td>101</td>\n      <td>76</td>\n      <td>48</td>\n      <td>180</td>\n      <td>32.9</td>\n      <td>0.171</td>\n      <td>63</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>764</th>\n      <td>2</td>\n      <td>122</td>\n      <td>70</td>\n      <td>27</td>\n      <td>0</td>\n      <td>36.8</td>\n      <td>0.340</td>\n      <td>27</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>766</th>\n      <td>1</td>\n      <td>126</td>\n      <td>60</td>\n      <td>0</td>\n      <td>0</td>\n      <td>30.1</td>\n      <td>0.349</td>\n      <td>47</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>767</th>\n      <td>1</td>\n      <td>93</td>\n      <td>70</td>\n      <td>31</td>\n      <td>0</td>\n      <td>30.4</td>\n      <td>0.315</td>\n      <td>23</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>768 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#f9ff256e .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":40,\"status\":\"ok\",\"timestamp\":1754660730399,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=7}\n``` {.python .cell-code}\n# Select top N number of records (default = 5)\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n      <td>148</td>\n      <td>72</td>\n      <td>35</td>\n      <td>0</td>\n      <td>33.6</td>\n      <td>0.627</td>\n      <td>50</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>85</td>\n      <td>66</td>\n      <td>29</td>\n      <td>0</td>\n      <td>26.6</td>\n      <td>0.351</td>\n      <td>31</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>89</td>\n      <td>66</td>\n      <td>23</td>\n      <td>94</td>\n      <td>28.1</td>\n      <td>0.167</td>\n      <td>21</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>137</td>\n      <td>40</td>\n      <td>35</td>\n      <td>168</td>\n      <td>43.1</td>\n      <td>2.288</td>\n      <td>33</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#76f7d8ba .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":22,\"status\":\"ok\",\"timestamp\":1754660733042,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=8}\n``` {.python .cell-code}\n# Select bottom N number of records (default = 5)\ndf.tail()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>763</th>\n      <td>10</td>\n      <td>101</td>\n      <td>76</td>\n      <td>48</td>\n      <td>180</td>\n      <td>32.9</td>\n      <td>0.171</td>\n      <td>63</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>764</th>\n      <td>2</td>\n      <td>122</td>\n      <td>70</td>\n      <td>27</td>\n      <td>0</td>\n      <td>36.8</td>\n      <td>0.340</td>\n      <td>27</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>766</th>\n      <td>1</td>\n      <td>126</td>\n      <td>60</td>\n      <td>0</td>\n      <td>0</td>\n      <td>30.1</td>\n      <td>0.349</td>\n      <td>47</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>767</th>\n      <td>1</td>\n      <td>93</td>\n      <td>70</td>\n      <td>31</td>\n      <td>0</td>\n      <td>30.4</td>\n      <td>0.315</td>\n      <td>23</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#d700271e .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":9,\"status\":\"ok\",\"timestamp\":1754660735393,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=9}\n``` {.python .cell-code}\n# Check the column data types\ndf.dtypes\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\nPregnancies                   int64\nGlucose                       int64\nBloodPressure                 int64\nSkinThickness                 int64\nInsulin                       int64\nBMI                         float64\nDiabetesPedigreeFunction    float64\nAge                           int64\nOutcome                       int64\ndtype: object\n```\n:::\n:::\n\n\n::: {#6a154982 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":12,\"status\":\"ok\",\"timestamp\":1754660737950,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=10}\n``` {.python .cell-code}\n# Get the number of rows and columns in your dataframe\ndf.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\n(768, 9)\n```\n:::\n:::\n\n\n::: {#ce17c607 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":24,\"status\":\"ok\",\"timestamp\":1754660740544,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=11}\n``` {.python .cell-code}\n# The info method gives the column datatypes + number of non-null values\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 768 entries, 0 to 767\nData columns (total 9 columns):\n #   Column                    Non-Null Count  Dtype  \n---  ------                    --------------  -----  \n 0   Pregnancies               768 non-null    int64  \n 1   Glucose                   768 non-null    int64  \n 2   BloodPressure             768 non-null    int64  \n 3   SkinThickness             768 non-null    int64  \n 4   Insulin                   768 non-null    int64  \n 5   BMI                       768 non-null    float64\n 6   DiabetesPedigreeFunction  768 non-null    float64\n 7   Age                       768 non-null    int64  \n 8   Outcome                   768 non-null    int64  \ndtypes: float64(2), int64(7)\nmemory usage: 54.1 KB\n```\n:::\n:::\n\n\n## Subsetting DataFrames\n\n::: {#e0ed4013 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":51,\"status\":\"ok\",\"timestamp\":1754660782657,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=12}\n``` {.python .cell-code}\n# Select one column using double brackets\ndf[['Pregnancies']].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#8ce4b43c .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":252,\"status\":\"ok\",\"timestamp\":1754660787093,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=13}\n``` {.python .cell-code}\ntype(df[['Pregnancies']].head())\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\npandas.core.frame.DataFrame\n```\n:::\n:::\n\n\n::: {#1d03ac50 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":28,\"status\":\"ok\",\"timestamp\":1754660791284,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=14}\n``` {.python .cell-code}\n# Select multiple columns using double brackets\ndf[['Pregnancies', 'Glucose']].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n      <td>148</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>85</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>89</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>137</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#9f3f8908 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":221,\"status\":\"ok\",\"timestamp\":1754654558219,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=15}\n``` {.python .cell-code}\ntype(df[['Pregnancies', 'Glucose']].head())\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\npandas.core.frame.DataFrame\n```\n:::\n:::\n\n\n::: {#f8379420 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":45,\"status\":\"ok\",\"timestamp\":1754655009275,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=16}\n``` {.python .cell-code}\n# Select one column using single brackets\n# This produces a pandas series which is a one-dimentional array that can be labeled\ndf['Pregnancies'].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```\n0    6\n1    1\n2    8\n3    1\n4    0\nName: Pregnancies, dtype: int64\n```\n:::\n:::\n\n\n::: {#732df89e .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":180,\"status\":\"ok\",\"timestamp\":1754655014899,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=17}\n``` {.python .cell-code}\ntype(df['Pregnancies'].head())\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\npandas.core.series.Series\n```\n:::\n:::\n\n\n::: {#17f40fc7 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":55,\"status\":\"error\",\"timestamp\":1754654924580,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=18}\n``` {.python .cell-code}\n# Keep in mind that you can't select multiple columns using single brackets\ndf['Pregnancies', 'Glucose']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">/opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pandas/core/indexes/base.py:3812</span>, in <span class=\"ansi-cyan-fg\">Index.get_loc</span><span class=\"ansi-blue-fg\">(self, key)</span>\n<span class=\"ansi-green-fg\">   3811</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">try</span>:\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">3812</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">_engine</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">get_loc</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">casted_key</span><span class=\"ansi-yellow-bg\">)</span>\n<span class=\"ansi-green-fg\">   3813</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">except</span> <span style=\"font-weight:bold;color:rgb(215,95,95)\">KeyError</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">as</span> err:\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">pandas/_libs/index.pyx:167</span>, in <span class=\"ansi-cyan-fg\">pandas._libs.index.IndexEngine.get_loc</span><span class=\"ansi-blue-fg\">()</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">pandas/_libs/index.pyx:196</span>, in <span class=\"ansi-cyan-fg\">pandas._libs.index.IndexEngine.get_loc</span><span class=\"ansi-blue-fg\">()</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">pandas/_libs/hashtable_class_helper.pxi:7088</span>, in <span class=\"ansi-cyan-fg\">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class=\"ansi-blue-fg\">()</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">pandas/_libs/hashtable_class_helper.pxi:7096</span>, in <span class=\"ansi-cyan-fg\">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class=\"ansi-blue-fg\">()</span>\n\n<span class=\"ansi-red-fg\">KeyError</span>: ('Pregnancies', 'Glucose')\n\nThe above exception was the direct cause of the following exception:\n\n<span class=\"ansi-red-fg\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansi-cyan-fg\">Cell</span><span class=\"ansi-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[18]</span><span class=\"ansi-green-fg\">, line 2</span>\n<span class=\"ansi-green-fg\">      1</span> <span style=\"font-style:italic;color:rgb(95,135,135)\"># Keep in mind that you can't select multiple columns using single brackets</span>\n<span class=\"ansi-green-fg\">----&gt; </span><span class=\"ansi-green-fg\">2</span> <span class=\"ansi-yellow-bg\">df</span><span class=\"ansi-yellow-bg\">[</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">Pregnancies</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">Glucose</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">]</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">/opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pandas/core/frame.py:4107</span>, in <span class=\"ansi-cyan-fg\">DataFrame.__getitem__</span><span class=\"ansi-blue-fg\">(self, key)</span>\n<span class=\"ansi-green-fg\">   4105</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"color:rgb(0,135,0)\">self</span>.columns.nlevels &gt; <span class=\"ansi-green-fg\">1</span>:\n<span class=\"ansi-green-fg\">   4106</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span style=\"color:rgb(0,135,0)\">self</span>._getitem_multilevel(key)\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">4107</span> indexer = <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">columns</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">get_loc</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">key</span><span class=\"ansi-yellow-bg\">)</span>\n<span class=\"ansi-green-fg\">   4108</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> is_integer(indexer):\n<span class=\"ansi-green-fg\">   4109</span>     indexer = [indexer]\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">/opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pandas/core/indexes/base.py:3819</span>, in <span class=\"ansi-cyan-fg\">Index.get_loc</span><span class=\"ansi-blue-fg\">(self, key)</span>\n<span class=\"ansi-green-fg\">   3814</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"color:rgb(0,135,0)\">isinstance</span>(casted_key, <span style=\"color:rgb(0,135,0)\">slice</span>) <span style=\"font-weight:bold;color:rgb(175,0,255)\">or</span> (\n<span class=\"ansi-green-fg\">   3815</span>         <span style=\"color:rgb(0,135,0)\">isinstance</span>(casted_key, abc.Iterable)\n<span class=\"ansi-green-fg\">   3816</span>         <span style=\"font-weight:bold;color:rgb(175,0,255)\">and</span> <span style=\"color:rgb(0,135,0)\">any</span>(<span style=\"color:rgb(0,135,0)\">isinstance</span>(x, <span style=\"color:rgb(0,135,0)\">slice</span>) <span style=\"font-weight:bold;color:rgb(0,135,0)\">for</span> x <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> casted_key)\n<span class=\"ansi-green-fg\">   3817</span>     ):\n<span class=\"ansi-green-fg\">   3818</span>         <span style=\"font-weight:bold;color:rgb(0,135,0)\">raise</span> InvalidIndexError(key)\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">3819</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">raise</span> <span style=\"font-weight:bold;color:rgb(215,95,95)\">KeyError</span>(key) <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span><span style=\"color:rgb(188,188,188)\"> </span><span class=\"ansi-blue-fg ansi-bold\">err</span>\n<span class=\"ansi-green-fg\">   3820</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">except</span> <span style=\"font-weight:bold;color:rgb(215,95,95)\">TypeError</span>:\n<span class=\"ansi-green-fg\">   3821</span>     <span style=\"font-style:italic;color:rgb(95,135,135)\"># If we have a listlike key, _check_indexing_error will raise</span>\n<span class=\"ansi-green-fg\">   3822</span>     <span style=\"font-style:italic;color:rgb(95,135,135)\">#  InvalidIndexError. Otherwise we fall through and re-raise</span>\n<span class=\"ansi-green-fg\">   3823</span>     <span style=\"font-style:italic;color:rgb(95,135,135)\">#  the TypeError.</span>\n<span class=\"ansi-green-fg\">   3824</span>     <span style=\"color:rgb(0,135,0)\">self</span>._check_indexing_error(key)\n\n<span class=\"ansi-red-fg\">KeyError</span>: ('Pregnancies', 'Glucose')</pre>\n```\n:::\n\n:::\n:::\n\n\nWith a pandas series, we can select rows using slicing like this: [start_index:end_index].\nThe end_index is not inclusive. This behavior is very similar to Python lists.\n\n::: {#2402d8b5 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":14,\"status\":\"ok\",\"timestamp\":1754655888447,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=19}\n``` {.python .cell-code}\ndf['Age']\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```\n0      50\n1      31\n2      32\n3      21\n4      33\n       ..\n763    63\n764    27\n765    30\n766    47\n767    23\nName: Age, Length: 768, dtype: int64\n```\n:::\n:::\n\n\n::: {#ec4c3c21 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":10,\"status\":\"ok\",\"timestamp\":1754655917783,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=20}\n``` {.python .cell-code}\ndf['Age'][0:10]\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\n0    50\n1    31\n2    32\n3    21\n4    33\n5    30\n6    26\n7    29\n8    53\n9    54\nName: Age, dtype: int64\n```\n:::\n:::\n\n\n::: {#177d4916 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":8,\"status\":\"ok\",\"timestamp\":1754656153042,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=21}\n``` {.python .cell-code}\ndf.Age.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\n0    50\n1    31\n2    32\n3    21\n4    33\nName: Age, dtype: int64\n```\n:::\n:::\n\n\n::: {#2d124dfa .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":353,\"status\":\"ok\",\"timestamp\":1754656169837,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=22}\n``` {.python .cell-code}\ntype(df.Age.head())\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\npandas.core.series.Series\n```\n:::\n:::\n\n\nThe pandas attribute .loc allow you to select columns, index, and slice your data\n\n::: {#fd9df0a1 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":12,\"status\":\"ok\",\"timestamp\":1754657945352,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=23}\n``` {.python .cell-code}\n# pandas dataframe\ndf.loc[:, ['Age']].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>32</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>33</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#f7edd93e .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":9,\"status\":\"ok\",\"timestamp\":1754657967921,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=24}\n``` {.python .cell-code}\n# pandas series\ndf.loc[:, 'Age'].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```\n0    50\n1    31\n2    32\n3    21\n4    33\nName: Age, dtype: int64\n```\n:::\n:::\n\n\n::: {#c49396c9 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":12,\"status\":\"ok\",\"timestamp\":1754658428021,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=25}\n``` {.python .cell-code}\ndf['Pregnancies'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\nPregnancies\n1     135\n0     111\n2     103\n3      75\n4      68\n5      57\n6      50\n7      45\n8      38\n9      28\n10     24\n11     11\n13     10\n12      9\n14      2\n17      1\n15      1\nName: count, dtype: int64\n```\n:::\n:::\n\n\n## Filtering DataFrames\n\n::: {#66417baf .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":9,\"status\":\"ok\",\"timestamp\":1754663064988,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=26}\n``` {.python .cell-code}\n# Notice that the filter produces a pandas series of True and False values\nfilter_pregnancies = df['Pregnancies'] >= 3\nfilter_pregnancies\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\n0       True\n1      False\n2       True\n3      False\n4      False\n       ...  \n763     True\n764    False\n765     True\n766    False\n767    False\nName: Pregnancies, Length: 768, dtype: bool\n```\n:::\n:::\n\n\n::: {#b89f511d .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":58,\"status\":\"ok\",\"timestamp\":1754661404831,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=27}\n``` {.python .cell-code}\nfilter_pregnancies.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\n0     True\n1    False\n2     True\n3    False\n4    False\nName: Pregnancies, dtype: bool\n```\n:::\n:::\n\n\n::: {#b7ddd1c0 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":52,\"status\":\"ok\",\"timestamp\":1754661412448,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=28}\n``` {.python .cell-code}\ndf[filter_pregnancies]\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n      <td>148</td>\n      <td>72</td>\n      <td>35</td>\n      <td>0</td>\n      <td>33.6</td>\n      <td>0.627</td>\n      <td>50</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5</td>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0</td>\n      <td>25.6</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>3</td>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>88</td>\n      <td>31.0</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>10</td>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.3</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>759</th>\n      <td>6</td>\n      <td>190</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.5</td>\n      <td>0.278</td>\n      <td>66</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>761</th>\n      <td>9</td>\n      <td>170</td>\n      <td>74</td>\n      <td>31</td>\n      <td>0</td>\n      <td>44.0</td>\n      <td>0.403</td>\n      <td>43</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>9</td>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0</td>\n      <td>22.5</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>763</th>\n      <td>10</td>\n      <td>101</td>\n      <td>76</td>\n      <td>48</td>\n      <td>180</td>\n      <td>32.9</td>\n      <td>0.171</td>\n      <td>63</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>419 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#e52f19ac .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":25,\"status\":\"ok\",\"timestamp\":1754661418540,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=29}\n``` {.python .cell-code}\ndf.loc[filter_pregnancies, :]\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>6</td>\n      <td>148</td>\n      <td>72</td>\n      <td>35</td>\n      <td>0</td>\n      <td>33.6</td>\n      <td>0.627</td>\n      <td>50</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5</td>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0</td>\n      <td>25.6</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>3</td>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>88</td>\n      <td>31.0</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>10</td>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.3</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>759</th>\n      <td>6</td>\n      <td>190</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.5</td>\n      <td>0.278</td>\n      <td>66</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>761</th>\n      <td>9</td>\n      <td>170</td>\n      <td>74</td>\n      <td>31</td>\n      <td>0</td>\n      <td>44.0</td>\n      <td>0.403</td>\n      <td>43</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>9</td>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0</td>\n      <td>22.5</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>763</th>\n      <td>10</td>\n      <td>101</td>\n      <td>76</td>\n      <td>48</td>\n      <td>180</td>\n      <td>32.9</td>\n      <td>0.171</td>\n      <td>63</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>419 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#04ff21f1 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":81,\"status\":\"ok\",\"timestamp\":1754661439128,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=30}\n``` {.python .cell-code}\n# Notice that it looks like nothing changes\n# This is because we didn't update the dataframe after applying the filter\ndf['Pregnancies'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```\nPregnancies\n1     135\n0     111\n2     103\n3      75\n4      68\n5      57\n6      50\n7      45\n8      38\n9      28\n10     24\n11     11\n13     10\n12      9\n14      2\n17      1\n15      1\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#9f3ca300 .cell execution_count=31}\n``` {.python .cell-code}\n# Update the dataframe to contain observations with pregnancies <= 3\ndf = df.loc[filter_pregnancies, :]\n```\n:::\n\n\n::: {#950ad1cf .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":13,\"status\":\"ok\",\"timestamp\":1754661451794,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=32}\n``` {.python .cell-code}\ndf['Pregnancies'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\nPregnancies\n3     75\n4     68\n5     57\n6     50\n7     45\n8     38\n9     28\n10    24\n11    11\n13    10\n12     9\n14     2\n17     1\n15     1\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#25f21bb7 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":46,\"status\":\"ok\",\"timestamp\":1754662395881,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=33}\n``` {.python .cell-code}\ndf['Age'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```\nAge\n28    20\n41    18\n37    18\n31    16\n27    15\n30    15\n22    15\n29    15\n42    14\n24    14\n25    14\n45    13\n34    13\n38    13\n36    13\n26    12\n43    12\n39    12\n32    12\n40    12\n33    10\n46    10\n35     8\n51     8\n23     7\n50     7\n58     6\n44     6\n60     5\n54     5\n57     5\n21     5\n49     5\n52     5\n48     5\n47     5\n63     4\n55     4\n56     3\n53     3\n66     3\n69     2\n61     2\n67     2\n65     2\n59     1\n81     1\n64     1\n62     1\n70     1\n68     1\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#b442ac5f .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":11,\"status\":\"ok\",\"timestamp\":1754662506892,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=34}\n``` {.python .cell-code}\n# Notice that the filter produces a pandas series of True and False values\ndf['Age'] <= 38\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```\n0      False\n2       True\n5       True\n6       True\n7       True\n       ...  \n759    False\n761    False\n762     True\n763    False\n765     True\nName: Age, Length: 419, dtype: bool\n```\n:::\n:::\n\n\n::: {#f7b42562 .cell execution_count=35}\n``` {.python .cell-code}\nfilter_age = df['Age'] <= 38\n```\n:::\n\n\n::: {#256c11dc .cell execution_count=36}\n``` {.python .cell-code}\ndf = df.loc[filter_age, :]\n```\n:::\n\n\n::: {#5693405b .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":20,\"status\":\"ok\",\"timestamp\":1754662842299,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=37}\n``` {.python .cell-code}\ndf['Age'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n```\nAge\n28    20\n37    18\n31    16\n30    15\n22    15\n27    15\n29    15\n24    14\n25    14\n34    13\n36    13\n38    13\n32    12\n26    12\n33    10\n35     8\n23     7\n21     5\nName: count, dtype: int64\n```\n:::\n:::\n\n\n### Combining filters\n\n::: {#0e736707 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":70,\"status\":\"ok\",\"timestamp\":1754663151218,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=38}\n``` {.python .cell-code}\ndf.loc[filter_pregnancies & filter_age, :]\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BloodPressure</th>\n      <th>SkinThickness</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DiabetesPedigreeFunction</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5</td>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0</td>\n      <td>25.6</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>3</td>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>88</td>\n      <td>31.0</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>10</td>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.3</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>4</td>\n      <td>110</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0</td>\n      <td>37.6</td>\n      <td>0.191</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>748</th>\n      <td>3</td>\n      <td>187</td>\n      <td>70</td>\n      <td>22</td>\n      <td>200</td>\n      <td>36.4</td>\n      <td>0.408</td>\n      <td>36</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>750</th>\n      <td>4</td>\n      <td>136</td>\n      <td>70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>31.2</td>\n      <td>1.182</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>752</th>\n      <td>3</td>\n      <td>108</td>\n      <td>62</td>\n      <td>24</td>\n      <td>0</td>\n      <td>26.0</td>\n      <td>0.223</td>\n      <td>25</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>9</td>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0</td>\n      <td>22.5</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>235 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Managing DataFrame columns\n\n::: {#23c54373 .cell execution_count=39}\n``` {.python .cell-code}\n# Rename column names\ndf3 = df.rename(columns={\n    'BloodPressure': 'BP',\n    'SkinThickness': 'ST',\n    'DiabetesPedigreeFunction': 'DPF'\n})\n```\n:::\n\n\n::: {#8d991924 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":43,\"status\":\"ok\",\"timestamp\":1754665503559,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=40}\n``` {.python .cell-code}\ndf3\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BP</th>\n      <th>ST</th>\n      <th>Insulin</th>\n      <th>BMI</th>\n      <th>DPF</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0</td>\n      <td>23.3</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5</td>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0</td>\n      <td>25.6</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>3</td>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>88</td>\n      <td>31.0</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>10</td>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.3</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>4</td>\n      <td>110</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0</td>\n      <td>37.6</td>\n      <td>0.191</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>748</th>\n      <td>3</td>\n      <td>187</td>\n      <td>70</td>\n      <td>22</td>\n      <td>200</td>\n      <td>36.4</td>\n      <td>0.408</td>\n      <td>36</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>750</th>\n      <td>4</td>\n      <td>136</td>\n      <td>70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>31.2</td>\n      <td>1.182</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>752</th>\n      <td>3</td>\n      <td>108</td>\n      <td>62</td>\n      <td>24</td>\n      <td>0</td>\n      <td>26.0</td>\n      <td>0.223</td>\n      <td>25</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>9</td>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0</td>\n      <td>22.5</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>112</td>\n      <td>26.2</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>235 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#045b6f93 .cell execution_count=41}\n``` {.python .cell-code}\n# This approach allows you to drop multiple columns at a time\ndf3 = df3.drop(columns=['Insulin', 'BMI'])\n```\n:::\n\n\n::: {#f8256c3f .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":33,\"status\":\"ok\",\"timestamp\":1754665870349,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=42}\n``` {.python .cell-code}\ndf3\n```\n\n::: {.cell-output .cell-output-display execution_count=42}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pregnancies</th>\n      <th>Glucose</th>\n      <th>BP</th>\n      <th>ST</th>\n      <th>DPF</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>8</td>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5</td>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>3</td>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>10</td>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>4</td>\n      <td>110</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0.191</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>748</th>\n      <td>3</td>\n      <td>187</td>\n      <td>70</td>\n      <td>22</td>\n      <td>0.408</td>\n      <td>36</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>750</th>\n      <td>4</td>\n      <td>136</td>\n      <td>70</td>\n      <td>0</td>\n      <td>1.182</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>752</th>\n      <td>3</td>\n      <td>108</td>\n      <td>62</td>\n      <td>24</td>\n      <td>0.223</td>\n      <td>25</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>9</td>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>5</td>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>235 rows × 7 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#1f7fd957 .cell execution_count=43}\n``` {.python .cell-code}\n# Approach 2\ndel df3['Pregnancies']\n```\n:::\n\n\n::: {#f1fc7ad8 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":35,\"status\":\"ok\",\"timestamp\":1754665974472,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=44}\n``` {.python .cell-code}\ndf3\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Glucose</th>\n      <th>BP</th>\n      <th>ST</th>\n      <th>DPF</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>110</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0.191</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>748</th>\n      <td>187</td>\n      <td>70</td>\n      <td>22</td>\n      <td>0.408</td>\n      <td>36</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>750</th>\n      <td>136</td>\n      <td>70</td>\n      <td>0</td>\n      <td>1.182</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>752</th>\n      <td>108</td>\n      <td>62</td>\n      <td>24</td>\n      <td>0.223</td>\n      <td>25</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>235 rows × 6 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Calculating statistics\n\n::: {#e5459503 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":13,\"status\":\"ok\",\"timestamp\":1754666157210,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=45}\n``` {.python .cell-code}\ndf3.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```\n(235, 6)\n```\n:::\n:::\n\n\n::: {#99573d07 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":45,\"status\":\"ok\",\"timestamp\":1754666230948,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=46}\n``` {.python .cell-code}\ndf3['Glucose'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=46}\n```\nnp.int64(28536)\n```\n:::\n:::\n\n\n::: {#30152e80 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":25,\"status\":\"ok\",\"timestamp\":1754666279764,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=47}\n``` {.python .cell-code}\ndf3['DPF'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=47}\n```\nnp.float64(102.571)\n```\n:::\n:::\n\n\n::: {#189dcf14 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":408,\"status\":\"ok\",\"timestamp\":1754666305086,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=48}\n``` {.python .cell-code}\ndf3.sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n```\nGlucose    28536.000\nBP         15807.000\nST          4272.000\nDPF          102.571\nAge         7004.000\nOutcome       88.000\ndtype: float64\n```\n:::\n:::\n\n\n::: {#ad778c94 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":14,\"status\":\"ok\",\"timestamp\":1754666346765,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=49}\n``` {.python .cell-code}\n'Mike' + 'George'\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n```\n'MikeGeorge'\n```\n:::\n:::\n\n\n::: {#2726c84f .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":14,\"status\":\"ok\",\"timestamp\":1754666403099,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=50}\n``` {.python .cell-code}\ndf3.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nIndex: 235 entries, 2 to 765\nData columns (total 6 columns):\n #   Column   Non-Null Count  Dtype  \n---  ------   --------------  -----  \n 0   Glucose  235 non-null    int64  \n 1   BP       235 non-null    int64  \n 2   ST       235 non-null    int64  \n 3   DPF      235 non-null    float64\n 4   Age      235 non-null    int64  \n 5   Outcome  235 non-null    int64  \ndtypes: float64(1), int64(5)\nmemory usage: 12.9 KB\n```\n:::\n:::\n\n\n::: {#16e01efc .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":24,\"status\":\"ok\",\"timestamp\":1754667320415,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=51}\n``` {.python .cell-code}\ndf3.values\n```\n\n::: {.cell-output .cell-output-display execution_count=51}\n```\narray([[1.83e+02, 6.40e+01, 0.00e+00, 6.72e-01, 3.20e+01, 1.00e+00],\n       [1.16e+02, 7.40e+01, 0.00e+00, 2.01e-01, 3.00e+01, 0.00e+00],\n       [7.80e+01, 5.00e+01, 3.20e+01, 2.48e-01, 2.60e+01, 1.00e+00],\n       ...,\n       [1.08e+02, 6.20e+01, 2.40e+01, 2.23e-01, 2.50e+01, 0.00e+00],\n       [8.90e+01, 6.20e+01, 0.00e+00, 1.42e-01, 3.30e+01, 0.00e+00],\n       [1.21e+02, 7.20e+01, 2.30e+01, 2.45e-01, 3.00e+01, 0.00e+00]],\n      shape=(235, 6))\n```\n:::\n:::\n\n\n::: {#fdb7cdcc .cell execution_count=52}\n``` {.python .cell-code}\ndf3 = df3.loc[filter_age & filter_pregnancies, :]\n```\n:::\n\n\n::: {#efc6ffaa .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":25,\"status\":\"ok\",\"timestamp\":1754667606918,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=53}\n``` {.python .cell-code}\ndf3\n```\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Glucose</th>\n      <th>BP</th>\n      <th>ST</th>\n      <th>DPF</th>\n      <th>Age</th>\n      <th>Outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>183</td>\n      <td>64</td>\n      <td>0</td>\n      <td>0.672</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>116</td>\n      <td>74</td>\n      <td>0</td>\n      <td>0.201</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>78</td>\n      <td>50</td>\n      <td>32</td>\n      <td>0.248</td>\n      <td>26</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>115</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.134</td>\n      <td>29</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>110</td>\n      <td>92</td>\n      <td>0</td>\n      <td>0.191</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>748</th>\n      <td>187</td>\n      <td>70</td>\n      <td>22</td>\n      <td>0.408</td>\n      <td>36</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>750</th>\n      <td>136</td>\n      <td>70</td>\n      <td>0</td>\n      <td>1.182</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>752</th>\n      <td>108</td>\n      <td>62</td>\n      <td>24</td>\n      <td>0.223</td>\n      <td>25</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>762</th>\n      <td>89</td>\n      <td>62</td>\n      <td>0</td>\n      <td>0.142</td>\n      <td>33</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>765</th>\n      <td>121</td>\n      <td>72</td>\n      <td>23</td>\n      <td>0.245</td>\n      <td>30</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>235 rows × 6 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#026d6a64 .cell execution_count=54}\n``` {.python .cell-code}\n# Export DataFrame to csv file\ndf3.to_csv(path_or_buf = 'diabetes2.csv', index = False)\n```\n:::\n\n\n::: {#a466c548 .cell quarto-private-1='{\"key\":\"executionInfo\",\"value\":{\"elapsed\":37,\"status\":\"ok\",\"timestamp\":1754668068393,\"user\":{\"displayName\":\"Xuebin Yang\",\"userId\":\"18047631927912204745\"},\"user_tz\":240}}' execution_count=55}\n``` {.python .cell-code}\ndf3.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=54}\n```\n(235, 6)\n```\n:::\n:::\n\n\n",
    "supporting": [
      "data_with_pandas_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}